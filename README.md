
# README

## Описание проекта

Этот проект предназначен для автоматического нахождения и классификации дефектов на оборудовании по изображениям ноутбуков с использованием модели YOLO (You Only Look Once). Мы используем библиотеки `Ultralytics` и `OpenCV` для работы с изображениями и аннотациями.

## Задача хакатона

В задании предлагается решить проблему автоматического обнаружения и классификации дефектов на оборудовании по изображениям. Необходимо реализовать одну или несколько моделей машинного обучения, способных детектировать дефекты на фотографии и классифицировать их.

**Результатом работы приложения является заполненный отчет о наличии дефектов ноутбука с указанием его серийного номера (номер вводится в приложении вручную).**

### Проблема

Визуальный осмотр ноутбуков занимает большое время. Человек может быть невнимателен и не заметить ошибку. Задача осмотра ноутбуков в удалённых локациях может быть сложной из-за необходимости отправки специалиста для произведения осмотра изделия.

### Решение

Идеальным решением является веб-приложение, содержащее самообучающуюся модель, которая может по набору фотографий определять, является ли данная конкретная модель дефектной или нет, и заносить эту информацию в протокол. 

При обнаружении дефекта на ноутбуке, дефект должен быть классифицирован, и его тип занесен в протокол. Протокол представляет собой краткий отчет, содержащий:
- найденные дефекты и их количество;
- серийный номер ноутбука;
- заключение о качестве (нет дефектов - контроль качества пройден, иначе не пройден).

Также предусмотрена возможность формирования статистического отчета для специалиста с аналитикой по найденным дефектам.

Веб-приложение должно быть удобным для работы инженера по качеству. В идеальном сценарии он загружает в приложение набор фотографий ноутбука, получает визуальный отчет о имеющихся дефектах и может скорректировать результаты (в случае обнаружения ложных дефектов или неправильной классификации дефекта). 

### Вывод

В результате работы приложения инженер по качеству получает заполненный отчет о качестве ноутбука с серийным номером, обнаруженными на нем дефектами и их типами, а модель получает новые данные для последующего дообучения (при корректировке результатов инженером по качеству на дообучение модели уходят корректные данные).

## Структура файлов

```plaintext
project_root/
│
├── data/
│   ├── detect/
│   ├── train/
│   ├── val/
├── runs/
├── best.pt
├── data.yaml
├── defects.csv
├── hack-piter.ipynb
├── LICENSE
├── README.md
├── web_streamlit.py
└── yolo11n.pt
```

## Установка зависимостей

Перед первым запуском установите необходимые библиотеки:

```bash
pip install ultralytics
pip install opencv-python
```

## Подготовка данных

Данные хранятся в файле `defects.csv`, который содержит информацию о изображениях и их аннотациях.

### Пример кода для обработки данных:

```python
import pandas as pd

df = pd.read_csv("defects.csv", delimiter=";")
# Обработка данных...
```

## Обучение модели

Обучение модели YOLO выполняется следующим образом:

```python
from ultralytics import YOLO

model = YOLO('yolo11n.pt')
results = model.train(data='data.yaml', epochs=50, imgsz=640, batch=8)
```

## Применение модели

Вы можете протестировать модель на новых изображениях:

```python
import cv2

image = cv2.imread('path/to/image.jpg')
results = model(image)
# Обработка результатов...
```

## Запуск веб-приложения

Запустите веб-приложение с помощью:

```bash
streamlit run web_streamlit.py
```

## Лицензия

Проект лицензирован под лицензией MIT. Подробности в файле LICENSE.

## Дополнительная информация

Если у вас есть вопросы или нужна помощь, не стесняйтесь обращаться!
